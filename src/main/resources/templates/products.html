<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</title>
  <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="container">
  <header>
    <div class="header-content">
      <div>
        <h1>üõçÔ∏è –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏</h1>
        <p class="subtitle">–î–æ–±–∞–≤–ª—è–π—Ç–µ, —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ –∏ —É–¥–∞–ª—è–π—Ç–µ —Ç–æ–≤–∞—Ä—ã</p>
      </div>
      <!-- –ü–∞–Ω–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
      <div class="user-panel">
                <span class="user-info">
                    <span sec:authorize="hasRole('ADMIN')" class="role-badge badge-admin">üëë ADMIN</span>
                    <span sec:authorize="hasRole('USER')" class="role-badge badge-user">üë§ USER</span>
                    <strong sec:authentication="name">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</strong>
                </span>
        <form th:action="@{/logout}" method="post" style="display: inline;">
          <button type="submit" class="btn btn-logout">üö™ –í—ã—Ö–æ–¥</button>
        </form>
      </div>
    </div>
  </header>

  <main>
    <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Ç–æ–≤–∞—Ä–∞ - –¢–û–õ–¨–ö–û –î–õ–Ø ADMIN -->
    <section class="form-section" sec:authorize="hasRole('ADMIN')">
      <h2 th:text="${editMode} ? '‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä'">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h2>

      <form th:action="${editMode} ? @{/products/update/{id}(id=${product.id})} : @{/products/add}"
            th:object="${product}"
            method="post"
            class="product-form">

        <div class="form-group">
          <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞:</label>
          <input type="text"
                 id="name"
                 th:field="*{name}"
                 placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ù–æ—É—Ç–±—É–∫ Dell XPS 15"
                 class="form-input">
          <span th:if="${#fields.hasErrors('name')}"
                th:errors="*{name}"
                class="error-message"></span>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="price">–¶–µ–Ω–∞ (‚ÇΩ):</label>
            <input type="number"
                   id="price"
                   th:field="*{price}"
                   step="0.01"
                   placeholder="0.00"
                   class="form-input">
            <span th:if="${#fields.hasErrors('price')}"
                  th:errors="*{price}"
                  class="error-message"></span>
          </div>

          <div class="form-group">
            <label for="stockQuantity">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∞ —Å–∫–ª–∞–¥–µ:</label>
            <input type="number"
                   id="stockQuantity"
                   th:field="*{stockQuantity}"
                   placeholder="0"
                   class="form-input">
            <span th:if="${#fields.hasErrors('stockQuantity')}"
                  th:errors="*{stockQuantity}"
                  class="error-message"></span>
          </div>
        </div>

        <div class="button-group">
          <button type="submit" class="btn btn-primary">
            <span th:text="${editMode} ? 'üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è' : '‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä'">–î–æ–±–∞–≤–∏—Ç—å</span>
          </button>
          <a th:if="${editMode}" th:href="@{/products}" class="btn btn-secondary">‚ùå –û—Ç–º–µ–Ω–∞</a>
        </div>
      </form>
    </section>

    <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    <section class="info-message" sec:authorize="hasRole('USER')">
      <div class="alert alert-info">
        ‚ÑπÔ∏è –í—ã –≤–æ—à–ª–∏ –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å. –í—ã –º–æ–∂–µ—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤.
        –î–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤–æ–π–¥–∏—Ç–µ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä.
      </div>
    </section>

    <!-- –¢–∞–±–ª–∏—Ü–∞ —Ç–æ–≤–∞—Ä–æ–≤ -->
    <section class="table-section">
      <h2>üì¶ –°–ø–∏—Å–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤</h2>

      <div th:if="${#lists.isEmpty(products)}" class="empty-state">
        <p>üì≠ –¢–æ–≤–∞—Ä—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç. <span sec:authorize="hasRole('ADMIN')">–î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—ã–π —Ç–æ–≤–∞—Ä!</span></p>
      </div>

      <div th:unless="${#lists.isEmpty(products)}" class="table-wrapper">
        <table class="products-table">
          <thead>
          <tr>
            <th>ID</th>
            <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
            <th>–¶–µ–Ω–∞</th>
            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ</th>
            <th sec:authorize="hasRole('ADMIN')">–î–µ–π—Å—Ç–≤–∏—è</th>
          </tr>
          </thead>
          <tbody>
          <tr th:each="prod : ${products}"
              th:classappend="${prod.stockQuantity < 10} ? 'low-stock' : ''">
            <td th:text="${prod.id}">1</td>
            <td th:text="${prod.name}">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</td>
            <td th:text="${#numbers.formatDecimal(prod.price, 0, 'COMMA', 2, 'POINT')} + ' ‚ÇΩ'">1000.00 ‚ÇΩ</td>
            <td>
                            <span class="stock-badge"
                                  th:classappend="${prod.stockQuantity < 10} ? 'badge-warning' : 'badge-success'"
                                  th:text="${prod.stockQuantity}">50</span>
            </td>
            <td class="actions" sec:authorize="hasRole('ADMIN')">
              <a th:href="@{/products/edit/{id}(id=${prod.id})}"
                 class="btn-action btn-edit"
                 title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">‚úèÔ∏è</a>
              <a th:href="@{/products/delete/{id}(id=${prod.id})}"
                 class="btn-action btn-delete"
                 title="–£–¥–∞–ª–∏—Ç—å"
                 onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')">üóëÔ∏è</a>
            </td>
          </tr>
          </tbody>
        </table>

        <div class="table-footer">
          <p>–í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: <strong th:text="${#lists.size(products)}">0</strong></p>
        </div>
      </div>
    </section>
  </main>

  <footer>
    <p>¬© 2025 –°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–≤–∞—Ä–∞–º–∏ | –°–¥–µ–ª–∞–Ω–æ —Å Spring Boot & Spring Security</p>
  </footer>
</div>
</body>
</html>